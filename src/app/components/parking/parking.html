<div class="parking-container">
  <header class="parking-header">
    <div class="header-content">
      <h1>Sistema de Estacionamento</h1>
      <div class="user-info">
        <span>Bem-vindo, {{ usuario }}</span>
        @if (isAdmin) {
          <button class="btn-admin" (click)="openAdminModal()">Admin</button>
        }
        <button class="btn-logout" (click)="logout()">Sair</button>
      </div>
    </div>
  </header>

  <main class="parking-main">
    <div class="actions-bar">
      <div class="left-actions">
        <button class="btn-add" (click)="openAddModal()">
          + Adicionar Ve√≠culo
        </button>
        <button class="btn-export" (click)="openExportModal()">
          üìä Exportar Relat√≥rio
        </button>
      </div>
      <div class="search-container">
        <input
          type="text"
          class="search-input"
          [(ngModel)]="searchTerm"
          placeholder="üîç Buscar por modelo ou placa..."
        />
      </div>
      <div class="total-vehicles">
        Total de ve√≠culos: {{ filteredVehicles.length }}
      </div>
    </div>

    @if (filteredVehicles.length === 0 && vehicles.length === 0) {
      <div class="empty-state">
        <div class="empty-icon">üöó</div>
        <h2>Nenhum ve√≠culo estacionado</h2>
        <p>Clique em "Adicionar Ve√≠culo" para registrar um novo ve√≠culo no estacionamento.</p>
      </div>
    } @else if (filteredVehicles.length === 0) {
      <div class="empty-state">
        <div class="empty-icon">üîç</div>
        <h2>Nenhum ve√≠culo encontrado</h2>
        <p>N√£o encontramos ve√≠culos com os termos "{{ searchTerm }}"</p>
      </div>
    } @else {
      <div class="vehicles-grid">
        @for (vehicle of filteredVehicles; track vehicle.id) {
          <div class="vehicle-card">
            <div class="vehicle-header">
              <div class="vehicle-icon">üöó</div>
              <div class="vehicle-plate">{{ vehicle.placa }}</div>
            </div>

            <div class="vehicle-info">
              <div class="info-row">
                <span class="label">Marca:</span>
                <span class="value">{{ vehicle.marca }}</span>
              </div>
              <div class="info-row">
                <span class="label">Modelo:</span>
                <span class="value">{{ vehicle.modelo }}</span>
              </div>
              <div class="info-row">
                <span class="label">Entrada:</span>
                <span class="value">{{ vehicle.dataEntrada | date:'dd/MM/yyyy HH:mm' }}</span>
              </div>
              <div class="info-row">
                <span class="label">Tempo:</span>
                <span class="value time">{{ getTempoEstacionado(vehicle) }}</span>
              </div>
            </div>

            <button class="btn-checkout" (click)="openCheckoutModal(vehicle)">
              Retirada
            </button>
          </div>
        }
      </div>
    }
  </main>
</div>

@if (showAddModal) {
  <app-add-vehicle-modal
    (close)="closeAddModal()"
    (vehicleAdded)="onVehicleAdded()">
  </app-add-vehicle-modal>
}

@if (showCheckoutModal && selectedVehicle) {
  <app-checkout-modal
    [vehicle]="selectedVehicle"
    (close)="closeCheckoutModal()"
    (checkout)="onVehicleCheckedOut()">
  </app-checkout-modal>
}

@if (showExportModal) {
  <app-export-modal
    (close)="closeExportModal()">
  </app-export-modal>
}

@if (showAdminModal) {
  <app-admin-modal
    (close)="closeAdminModal()">
  </app-admin-modal>
}
